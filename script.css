document.addEventListener("DOMContentLoaded", function() {
  const body = document.body;

  // Fade in au chargement
  requestAnimationFrame(() => { body.style.opacity = 1; });

  // Fade out sur clic de lien
  const links = document.querySelectorAll('a[href]');
  links.forEach(link => {
    link.addEventListener('click', function(e) {
      const href = this.getAttribute('href');
      if (href.startsWith("#") || href.startsWith("mailto:") || href === "") return;
      e.preventDefault();
      body.style.opacity = 0;
      setTimeout(() => { window.location.href = href; }, 500);
    });
  });

  // ===== Slider manuel =====
  const track = document.querySelector('.slider-track');
  if(track) {
    const slides = Array.from(track.children);
    const btnLeft = document.querySelector('.slider-btn.left');
    const btnRight = document.querySelector('.slider-btn.right');
    let currentIndex = 0;

    function updateSlider() {
      const width = slides[0].getBoundingClientRect().width;
      track.style.transform = `translateX(-${currentIndex * width}px)`;
    }

    btnRight.addEventListener('click', () => {
      if(currentIndex < slides.length - 1) currentIndex++;
      else currentIndex = 0; // boucle
      updateSlider();
    });

    btnLeft.addEventListener('click', () => {
      if(currentIndex > 0) currentIndex--;
      else currentIndex = slides.length - 1; // boucle
      updateSlider();
    });

    window.addEventListener('resize', updateSlider);
    updateSlider(); // initialise correctement
  }
});
